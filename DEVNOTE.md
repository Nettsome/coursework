

## Какие библиотеки установил


Текущий `requirements.txt`
```txt
joblib==1.4.2
mordred==1.2.0
networkx==2.8.8
numpy==1.26.4
pandas==2.2.3
pillow==11.0.0
python-dateutil==2.9.0.post0
pytz==2024.2
rdkit==2024.3.6
scikit-learn==1.5.2
scipy==1.14.1
six==1.16.0
threadpoolctl==3.5.0
tzdata==2024.2
```


```pwsh
pip install numpy pandas rdkit scikit-learn mordred
```

Еще нужно будет установить библиотеку `setuptools`
```pwsh
pip install setuptools
```

Что еще установил вдальнейшем?
```pwsh
pip install seaborn matplotlib
```




## Задания

### Задание 1.

Вот есть такая таблица:
|     | SMILES                                     | plC50 | mol                                              | num_atoms | logP   |
| --- | ------------------------------------------ | ----- | ------------------------------------------------ | --------- | ------ |
| 0   | O=S(=O)(Nc1cccc(-c2cnc3ccccc3n2)c1)c1cccs1 | 4.26  | <rdkit.Chem.rdchem.Mol object at 0x7f59df45bc30> | 25        | 4.1591 |
| ... | ...                                        | ...   | ...                                              | ...       | ...    |

Мне нужно поготовить эти данные для последующей работы. Нужно добавить новые столбцы с полезными данными, полученными из заданных столбцов. 
Думаю добавить такие стобцы свойств:
- **Физико-химические свойства:**
  - **Молекулярная масса (Molecular Weight)**.
  - **Гидрофобность (logP)** — отражает растворимость в жирах и воде.
  - **Число водородных доноров и акцепторов (HBD, HBA)** — важно для предсказания проницаемости через мембраны.
  - **Полярная поверхность (TPSA)** — связана с биодоступностью.
- **Топологические индексы:**
  - **Показатель сложности молекулы (e.g., Wiener index, Zagreb index)**.
  - **Количество вращающихся связей (Rotatable Bonds)**.
  - **Кольцевая структура (e.g., Number of Rings)**.
- **Электронные свойства:**
  - Электронная плотность.
  - Заряд молекулы.
- **Функциональные группы:**
  - Подсчет специфических групп (например, ароматических колец, кислот, оснований).

 
В статье используют такие свойства:

![Some img](data/for_docs/Новые_свойства_для_таблицы_с_данными_RdKit.png)


**Подробно о каждом свойстве**



**Molecular Weight**


**logP**
Гидрофобность
Отражает растворимость в жирах и воде.
Или отражает, то насколько материал прилипает к воде. ...



**HBD**
Число водородных доноров.
Важно для предсказания проницаемости через мембраны.


**HBA**
Число водородных акцепторов


**TPSA**
Она есть вообще в моей таблице?


**Wiener index**
Какой-то показатель сложности молекулы


**Zagreb index**
Какой-то показатель сложности молекулы


**Rotatable Bonds**
Количество вращающихся связей


**Number of Rings**
Кольцевая структура


**...Что-то еще...**



### Задание 2.
Анализ данных.

Для начала нужно изучить корреляцию данных.
Для этого мне нужно построить таблицу корреляции.

---

**Про таблицу корреляции**
Эта таблица не дает каких-то точных данных о том, как связаны свойства молекул, потому что два высококоррелирующих признака могут коррелировать между собой при помощи признака посредника. 


Можно еще построить граф корреляции, на котором будет визуально понятно как связаны признаки вещества. 

---

**Мультиколлинеарность**

[Статья на хабре про мультиколлинеарность](https://habr.com/ru/companies/abdigital/articles/592493/)

**Отбор признаков на основе анализа доли объясненной дисперсии для компонент, полученных PCA. Метод предполагает переход в новое признаковое пространство, что не всегда возможно для задач, где необходима интерпретируемость.**

Нам лучше всего подходил первый метод, но нужно было как-то устранить его недостатки, поэтому мы решили модифицировать его. 

Наш метод основан на алгоритме Брона-Кербоша — одном из алгоритмов решения задач теории графов о поиске максимальных клик. Клика — это такой подграф, в котором все вершины попарно соединены друг с другом. Например, граф, нарисованный в форме логотипа Ак Барс Банка, содержит 15 клик размера 2 (ребра графа), 6 клик размера 3, и одну клику размера 4. 

![Граф в форме логотипа Ак Барс банка](https://habrastorage.org/r/w1560/getpro/habr/upload_files/0cb/ecc/581/0cbecc5819d53496965e1620fc273738.png)


Здесь можно увидеть аналогию с социальной сетью, где пользователи — это признаки, а наличие связи между ними говорит о том, что они «дружат». При этом наличие «дружбы» зависит от некоторой величины, которую можно вычислить для каждой пары пользователей. Задача состоит в том, чтобы выделить сообщество, в котором каждый его участник «дружит» с остальными.


**Как выделить оптимальную клику**

Так как метод применяется для задачи бинарной классификации с количественными признаками, то в качестве меры, показывающей связь между признаком и таргетом, предлагается использовать совместную информацию (MI — mutual information).

Для двух клик одинаковой длины, будем считать лучшей ту, для которой сумма MI, вычисленная для всех признаков клики, наибольшая. Конечно, здесь может использоваться и любая другая релевантная решаемой задаче мера, например, вычисленная с использованием дисперсионного анализа (ANOVA). 


### Задание 3.
Построение базовой модели.

Попробую построить модель на данных, полученных только с помощью библиотеки RDKit. 






## Кратко про работу с библиотекой Mordred


Класс Calculator считает свойства по объкту класса RdKit object

Класс descriptor указывает какие именно свойства нужно считать


Класс descriptor выглядит примерно так:

```python
class descriptor:

    Property prop1 = "some property"
    Property prop2 = "..."
    Property prop3 = "..."
```


Создать калькулятор можно так:
```python
calc = Calculator("# одно либо множество дескрипторов")
# например
calc = Calculator([descriptors.Weight, descriptors.LogP, descriptors.TPSA])

mordred_desc = calc(single_data)          # Для одного значения  
mordred_desc = calc.pandas(multiply_data) # Для массива или таблицы значение
```

Т.к. библиотека Mordred не особо оптимизирована, то лучше всего ужимать данные (т.е. уменьшать вычисляемые таблицы или уменьшать кол-во вычисляемых свойств) или применять оптимизацию.


### Примеры оптимизации

**Фильтрация дескрипторов**
```python
from mordred import Calculator, descriptors

# Выбор ограниченного набора дескрипторов
selected_descriptors = [descriptors.Weight, descriptors.LogP, descriptors.TPSA]
calc = Calculator(selected_descriptors)
mordred_desc = calc.pandas(data["mol"])
```


Для оптимизации я, например, разбивал датасет на части. ...




















## В чем суть моей курсовой?

1) Создать нейронку, которая будет генерировать вещества с какими-то наперед заданными свойствами. 

В статье писали про какое-то хранилище, к которому будет обращаться нейронка


2) Есть еще такая идея сути курсовой.
Думаю, мне надо сделать нейронку, которая на вход принимает строку в формате SMILES и возварщает свойтсва этого вещества.


### Как будет устроена (и будет обучаться) эта нейронка

Этот проект можно разделить на две части: генератор формул в виде SMILES и предсказатель свойств по этой формуле.



